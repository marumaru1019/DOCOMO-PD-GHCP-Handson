---
title: ⑥ 運用手順書の作成
categories: [運用, GitHub Copilot]
weight: 6
---

**運用フェーズ**では、定期的に行う**本番反映（デプロイ）**などのルーティンがあり、作業手順を**ドキュメント化**しておくことが重要です。ここでは、「**週次で本番環境に反映するフロー**」を例に、**GitHub Copilot** を活用して**運用手順書**を自動生成する方法を示します。ただし、本シナリオは特定クラウドではなく、一般的なサーバー環境での手順を想定します。

---

### :pen: 例題

**シナリオ**: 毎週水曜に**ステージング→本番**への反映を実行。**バージョンタグ**を付与して本番へデプロイし、**SmokeTest**や**ログ確認**を行う。

#### プロンプト例

```text
週次で行う本番反映手順書をMarkdownで作ってください。
以下のポイントを含めて:
1) GitHub上でバージョンタグを付ける
2) サーバーへのデプロイ（Java17アプリ）
3) SmokeTestの実施
4) ログ確認

対象アプリ: Java 17
```

---

### :robot: 出力例

```markdown
# 週次本番反映手順書

## 前提
- ステージング環境でテスト完了済み
- main ブランチに修正がマージされている

## 1. バージョンタグ付与
1. ローカルで最新コードを取得  
   git checkout main
   git pull origin main
2. バージョンタグを作成 (例: `v1.2.3`)  
   git tag v1.2.3
   git push origin v1.2.3

## 2. サーバーへのデプロイ
1. コードをビルド (例: Maven)
   mvn clean package
2. デプロイ用スクリプトを実行 (例: `deploy.sh`)
   ./deploy.sh v1.2.3
   - `deploy.sh` 内でサーバーへのSSHやファイル転送(SCP/rsync)を実行
   - Java17で動作する環境がサーバーに用意されている前提

## 3. SmokeTest の実施
1. 本番URLにアクセスして主要機能を確認 (ログイン/メッセージ送信など)
2. 重大エラーが発生しないか軽くテスト
3. 問題あれば、デプロイ前のバージョンへロールバックを検討

## 4. ログ確認
1. サーバーにSSHでログイン
2. アプリのログファイル (例: `/var/log/myapp.log`) を tail/grep で確認
   tail -f /var/log/myapp.log
3. エラーや警告が出ていないかチェック

## 補足
- 大きな機能追加時は DBマイグレーションが必要な場合あり
- リリース後24時間はログ重点監視を行い、問題があれば速やかにロールバック

```

Copilot は**Markdown形式**で作業手順を整理し、**コマンド例**や**チェックポイント**を合わせて提案してくれます。

---

### :memo: 練習

1. **他のホスティング方法**  
   - 例: 「Dockerでコンテナを再起動する」「systemdでサービスを再起動する」と指定  
   - Copilotがどのようなコマンド例を提案するか確認  
2. **通知や監視ツール連携**  
   - 「デプロイ後にSlack通知」「New RelicでAPMをチェック」などを追加依頼  
3. **Pull Requestで手順書をレビュー**  
   - Copilotの出力をチームがPRでレビューし、細部を加筆 → 運用フローを最新版に常に更新

---

## まとめ

- **定期的な本番反映**の流れは**常に同じ** → **Copilot** で**手順書**を素早く生成 → チーム全員が**統一したドキュメント**で作業  
- **CLIコマンド**や**確認手順**までMarkdown化 → **リポジトリやWiki**で共有  
- **Pull Request**で加筆修正 → **継続的に改善**しながら標準化を進める  

こうして**Copilot** を使った**運用手順書**の作成により、**人為ミス**を減らし、**作業の標準化**や**チーム学習**が効率的に進みます。