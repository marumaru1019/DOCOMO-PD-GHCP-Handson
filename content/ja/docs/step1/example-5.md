---
title: ⑤ カスタムチャットモード
categories: [GitHub Copilot, Agent Mode]
weight: 5
---

## 1. カスタムチャットモードとは？

カスタムチャットモードは、特定の作業に最適化された**指示とツールの組み合わせ**を事前定義し、素早く切り替えられる機能です。例えば「計画立案モード」では実装プランの生成に特化し、読み取り専用ツールのみを使用するといった設定が可能です。

> **ポイント**
>
> * **専用設定** … 特定タスクに最適化されたツールと指示の組み合わせ
> * **素早い切り替え** … チャットモードドロップダウンから瞬時に変更
> * **再利用可能** … ワークスペースまたはユーザープロファイルに保存
> * **チーム共有** … `.chatmode.md` ファイルでチーム全体の標準化

---

## 2. 実際の使用例での違い

**例：「ユーザー認証機能を追加したい」という要求**

**通常 + Copilot カスタマイゼーション:**
```typescript
// 自動的にコーディング規約が適用されたコードが生成
type AuthUser = {  // interface ではなく type
  id: string;
  email: string;
};

const LoginForm: React.FC = () => {  // 関数コンポーネント
  // styled-components を使用したスタイリング
  return <StyledForm>...</StyledForm>;
};
```

**Plan カスタムチャットモード:**
```markdown
# ユーザー認証機能 実装計画

## 概要
セキュアなユーザー認証システムを追加

## 実装手順
1. 認証ミドルウェアの作成
2. ユーザーモデルの設計
3. ログイン・ログアウトエンドポイント

# ※コードは生成されず、計画のみ
```

### 2.1 組み合わせ効果

実際は**両方を組み合わせて使用**することで最大効果を発揮：

1. **Review モード**を選択（コードレビューに特化）
2. **ツール**: `changes`, `problems`, `codebase` のみ使用
3. **カスタム指示**: セキュリティ重視のレビュー観点が自動適用
4. **結果**: セキュリティに焦点を当てた、一貫したレビューコメント

---

## 3. カスタムチャットモードの活用シーン

| モード例 | 目的 | 含まれるツール | 指示内容 |
|----------|------|----------------|----------|
| **Plan** | 実装計画立案 | `codebase`, `search`, `usages` | コード編集せず、計画のみ生成 |
| **Review** | コードレビュー | `changes`, `problems`, `codebase` | セキュリティと品質に重点 |
| **Debug** | デバッグ支援 | `problems`, `runTests`, `terminalSelection` | エラー解析と修正提案 |
| **Document** | ドキュメント作成 | `codebase`, `fetch`, `githubRepo` | README、API仕様書生成 |

---

## 4. チャットモードファイルの構造

### 4.1 基本構造

チャットモードファイル（`.chatmode.md`）は以下の構造を持ちます：

```markdown
---
description: "モードの簡単な説明（チャット入力欄に表示）"
tools: ['tool1', 'tool2', 'toolset1']
model: "Claude Sonnet 4"
---

# モード固有の指示

ここにそのモードでの具体的な指示や
ガイドラインを記述します。
```

### 4.2 Front Matter の設定項目

| 項目 | 説明 | 例 |
|------|------|-----|
| `description` | モードの説明文 | `"実装計画を生成するモード"` |
| `tools` | 使用可能なツール・ツールセット | `['codebase', 'search', 'usages']` |
| `model` | 使用するAIモデル | `"Claude Sonnet 4"` |

---

## 5. 具体的なチャットモード例

### :pen: 例題

「計画立案モード」を作成してみましょう。

```markdown
---
description: "新機能やリファクタリングの実装計画を生成"
tools: ['codebase', 'fetch', 'findTestFiles', 'githubRepo', 'search', 'usages']
model: "Claude Sonnet 4"
---

# 計画立案モードの指示

あなたは計画立案モードです。新機能の実装やコードのリファクタリングの計画を生成することが主な役割です。

**重要**: コードの編集は行わず、計画のみを生成してください。

## 計画の構成

生成する計画は以下のセクションを含むMarkdown文書としてください：

* **概要**: 機能やリファクタリングタスクの簡潔な説明
* **要件**: 機能やリファクタリングの要件リスト
* **実装手順**: 詳細な実装ステップ
* **テスト**: 検証に必要なテストの一覧
* **リスク**: 想定される課題や注意点
```

### :robot: 出力例

計画立案モードを使用すると、Copilot は以下のような応答をします：

**ユーザー:** 「ユーザー認証機能を追加したい」

**Copilot応答:**
```markdown
# ユーザー認証機能 実装計画

## 概要
セキュアなユーザー認証システムを既存のWebアプリケーションに追加します。

## 要件
- JWT トークンベースの認証
- ログイン・ログアウト機能
- パスワード暗号化（bcrypt）
- セッション管理

## 実装手順
1. 認証ミドルウェアの作成
2. ユーザーモデルの設計
3. ログイン・ログアウトエンドポイント
4. フロントエンド認証フォーム
5. 保護されたルートの実装

## テスト
- 認証フローのユニットテスト
- APIエンドポイントの統合テスト
- セキュリティテスト

## リスク
- セッション管理の複雑性
- XSS/CSRF 攻撃への対策が必要
```

---

## 6. チャットモードの作成と管理

### 6.1 新規作成手順

1. **コマンドパレット** → `Chat: New Mode File`
![チャットモードの作成](../images/chat-create.png)
1. **保存場所を選択**:
   - **Workspace**: `.github/chatmodes/` フォルダ（チーム共有）
   - **User Profile**: 個人設定（複数ワークスペースで使用）
2. **モード名を入力** （チャットモードドロップダウンに表示される名前）
3. **ファイル内容を編集** （Front Matter + 指示内容）

### 6.2 既存モードの管理

**チャットビューから管理:**
1. **チャットビュー** → **設定ボタン** → **Modes**
2. **既存モードを選択** して編集
3. **アクション**: コピー・移動・名前変更・削除

**コマンドパレットから:**
- `Chat: Configure Chat Modes` → モード選択 → 編集

---

## 7. 実践的な活用パターン

### 7.1 プロジェクト固有モード

```markdown
---
description: "API開発専用モード"
tools: ['editFiles', 'runTests', 'fetch', 'problems']
---

# API開発モード

REST APIの開発に特化したモードです。

## 開発指針
- OpenAPI仕様に準拠
- エラーハンドリングを必須実装
- レスポンス形式を統一
- 適切なHTTPステータスコード使用
```

### 7.2 チーム標準モード

```bash
# プロジェクト構造例
.github/
└── chatmodes/
    ├── plan.chatmode.md      # 計画立案
    ├── review.chatmode.md    # コードレビュー
    ├── debug.chatmode.md     # デバッグ支援
    └── document.chatmode.md  # ドキュメント作成
```

---

## :memo: 練習

1. **基本モード**: 自分の作業スタイルに合った基本的なチャットモードを作成してください
2. **専門モード**: 特定の技術スタック（React、Node.js等）に特化したモードを作成してください
3. **チームモード**: プロジェクトチーム向けの標準的なモードを設計してください

---

## 8. まとめ

* **カスタムチャットモード** で特定タスクに最適化された環境を瞬時に構築
* **`.chatmode.md`** ファイルで指示とツールの組み合わせを定義
* **チーム共有** でプロジェクト全体の作業効率を向上
* **段階的活用** で徐々にモードを拡充し、開発ワークフローを最適化
